services:
  firebase:
    build:
      context: .
      dockerfile: docker/firebase-emulator.Dockerfile
    working_dir: /firebase
    volumes:
      - ./firebase:/firebase
      - ./firebase-data:/firebase/firebase-data
      - ./firebase.json:/firebase.json:ro
    env_file:
      - .env.development
    ports:
      - "4000:4000" # Emulator UI
      - "8080:8080" # Firestore
      - "9099:9099" # Auth
    command: >
      sh -c "firebase emulators:start --only firestore,auth --project $$VITE_PROJECT_ID
      --import=/firebase/firebase-data --export-on-exit=/firebase/firebase-data
      --config /firebase.json"
